---
import type { Page } from 'astro';
import { maxDisplayPages } from '../site.config';

interface Props {
  page: Page;
  baseUrl: string;
}

const { page, baseUrl } = Astro.props;
const currentPage: number = page.currentPage;
const listStartPage: number =
  currentPage - maxDisplayPages >= 1 ? currentPage - maxDisplayPages : 1;
const listEndPage: number =
  currentPage + maxDisplayPages <= page.lastPage ? currentPage + maxDisplayPages : page.lastPage;
let pageList: { pageNum: number; isCurrent: boolean }[] = [];
for (let i = listStartPage; i <= listEndPage; i++) {
  pageList.push({ pageNum: i, isCurrent: i === currentPage });
}
Object.freeze(pageList);
---

<div class="mx-auto flex w-fit gap-2">
  {
    page.currentPage !== 1 ? (
      <div class="flex gap-2 py-2 text-xl">
        <a
          href={page.url.first}
          class="firstLast block h-10 w-10 rounded-full bg-violet-400 p-1 text-center"
        >
          &laquo;
        </a>
        <a
          href={page.url.prev}
          class="prevNext block h-10 w-10 rounded-full bg-violet-300 p-1 text-center"
        >
          &lt;
        </a>
      </div>
    ) : (
      <div class="w-[88px]" />
    )
  }
  <ul class="pageList flex gap-3 rounded-lg border border-violet-950 px-2 py-1">
    {
      pageList.map((eachPage) =>
        eachPage.isCurrent ? (
          <li class="pageCurrent block h-10 w-10 rounded-full bg-violet-950 p-2 text-center text-violet-100">
            {eachPage.pageNum}
          </li>
        ) : (
          <a href={`${baseUrl}/p${eachPage.pageNum}/`}>
            <li class="pages block h-10 w-10 rounded-full bg-violet-300 p-2 text-center">
              {eachPage.pageNum}
            </li>
          </a>
        ),
      )
    }
  </ul>
  {
    page.currentPage !== page.lastPage ? (
      <div class="flex gap-2 py-2 text-xl">
        <a
          href={page.url.next}
          class="prevNext block h-10 w-10 rounded-full bg-violet-300 p-1 text-center"
        >
          &gt;
        </a>
        <a
          href={page.url.last}
          class="firstLast block h-10 w-10 rounded-full bg-violet-400 p-1 text-center"
        >
          &raquo;
        </a>
      </div>
    ) : (
      <div class="w-[88px]" />
    )
  }
</div>
<p class="text-center">Page {page.currentPage} of {page.lastPage}</p>
<style>
  html:has(#themeToggle.dark) {
    .firstLast {
      @apply bg-violet-800;
    }
    .prevNext {
      @apply bg-violet-700;
    }
    .pageList {
      @apply border-violet-50;
    }
    .pages {
      @apply bg-violet-700;
    }
    .pageCurrent {
      @apply bg-violet-100 text-violet-950;
    }
  }
</style>
